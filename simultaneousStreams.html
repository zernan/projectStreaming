<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>

<title>Javascript Project</title>
	
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">
  <link rel="stylesheet" href="streamingData.css">	

</head>

<body>
<div class='container'>

	<h4 align='center'>STREAMING WEB APP</h4>
	
	<div id='dragAndDrop1' class='drag'	draggable='true'>
			
			<!--<h3>Twitch Clips</h3> -->
			<div class='twitch'></div>
	</div>	

	<div>
		<p id='coordinates'>COORDINATES</p>
	</div>

	<div id='dragAndDrop2' class='drag' draggable='true'>
				
		<!--<h3>Twitter Feed</h3> -->
		<div class='twitter'>
			<!-- <div id="twitter">
				<div id="twitter_t">
				</div>
				<div id="twitter_m">
				<div id="twitter_container">
				<ul id="twitter_update_list">
				</ul>
				</div>
				</div>
				</div>
				<div id="twitter_b">
				</div> -->
		</div>
	</div>
				
		
	<div id='dragAndDrop3' class='drag' draggable='true' align='center'>
				<h5>Type keyword to search streams</h5>
				<input type='text' id='txtBox'/>
				<button id='searchBtn' height=100px width=200px>Search</button>
	</div>
		
</div> <!-- end of class container -->

<script>

		
	let _startX = 0;
 	let _startY = 0;
 	let _offsetX = 0;
  	let _offsetY = 0;
 	let	_dragElement;
 	let _oldZIndex = 0;
 	
 	//get blue wave container coordinates
    let containerRect = document.getElementsByClassName('container')[0].getBoundingClientRect();
    
 	document.onmousedown = OnMouseDown;
 	document.onmouseup = OnMouseUp;

 	function getOffset(elem) {
  		elem = elem.getBoundingClientRect();
  		return {
    		left: elem.left + window.scrollX,
    		top: elem.top + window.scrollY
  		}
	}

 	function ExtractNumber(value) {
	
    	var n = parseInt(value);
		
		return n == null || isNaN(n) ? 0 : n;
	}

	
	function OnMouseMove(e){
	
    if (e == null) 
        e = window.event; 
    
    	// drag code
    	_dragElement.style.left = (_offsetX + e.clientX - _startX) + 'px';
    	_dragElement.style.top = (_offsetY + e.clientY - _startY) + 'px';
    	
    	//alert("dragElement.style.left= " +_dragElement.style.left+ ", dragElement.style.top= " + _dragElement.style.top);

    	document.getElementById('coordinates').innerHTML = 'clientXY: ' + e.clientX + ',' + e.clientY + '\n dragElementXY: ' + _dragElement.style.left + ',' + _dragElement.style.top + '\n offsetXY:' + _offsetX + ',' + _offsetY + '\n startXY: ' + _startX + ',' + _startY;
    }

	function OnMouseUp(e){
	
		if (_dragElement != null) {

			if(_dragElement.style.top < '0px'){
				_dragElement.style.top = '0px';
			}

			if(_dragElement.style.left < '0px'){
				_dragElement.style.left = '0px';
			}			

    		
    		_dragElement.style.zIndex = _oldZIndex;

	        // cleanup
    	    document.onmousemove = null;
        	document.onselectstart = null;
        	_dragElement.ondragstart = null;
        	_dragElement = null;
        }
	}
	
	function OnMouseDown(e){
		
		//for IE not passing event objects
		if(e == null) {
			e = window.event;
		}
		
		//e.stopPropagation();

		let target = e.target != null ? e.target : e.srcElement;

		if (target.className == 'drag') {
    	
    		// grab the mouse position
        	_startX = e.clientX;
        	_startY = e.clientY;
        	//alert("mouse position: " + _startX + ", " + _startY);
        	
        	// grab the clicked element's position
			//_offsetX = ExtractNumber(target.style.left);
        	//_offsetY = ExtractNumber(target.style.top);

        	_offsetX = ExtractNumber(target.getBoundingClientRect().left);
        	_offsetY = ExtractNumber(target.getBoundingClientRect().top);
        	
        	//alert("element position: " + target.style.left + ", " + target.style.top + ", "+ target.style.right + ", " + target.style.bottom);
        	//alert("offset position: " + _offsetX + ", " + _offsetY);

        	let containerElement = document.getElementsByClassName('container')[0];
        	let containerRect = containerElement.getBoundingClientRect();
        	//alert(" Container: left= " + containerRect.left + ", top= " + containerRect.top + ", right= " + containerRect.right + ", bottom= " + containerRect.bottom);


        	let rect = target.getBoundingClientRect(); 
        	//alert("Drag Element: left= " + rect.left + ", top= " + rect.top + ", right= " + rect.right + ", bottom= " + rect.bottom);
        	//alert("offsetXY = " + _offsetX + ", " + _offsetY + "\n TargetLeftTop = " + target.style.left + ", " + target.style.top);

        	// bring the clicked element to the front while it is being dragged
        	_oldZIndex = target.style.zIndex;
        	target.style.zIndex = 10000;

        	// we need to access the element in OnMouseMove
        	_dragElement = target;

        	// tell our code to start moving the element with the mouse
        	document.onmousemove = OnMouseMove;

        	// cancel out any text selections
        	document.body.focus();

        	// prevent text selection in IE
        	document.onselectstart = function () { return false; };
        	
        	// prevent IE from trying to drag an image
        	target.ondragstart = function() { return false; };
        
        	return false;
        }
    }
    
	</script>

	<script src='https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js'></script>
	
</body>
</html>